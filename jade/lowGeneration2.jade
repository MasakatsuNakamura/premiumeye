extends ./components/_header
block content
  .containar
    table.table
      thead
        tr
          - var HEADER = ["通知レベル", "対応状況", "顧客ID", "姓", "名", "会社名", "シリアル番号", "発電所名", "故障分類", "機器番号", "発生日時" ];
          each name in HEADER
            th=name
      tbody#mytable
    script(src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js")
    script(src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js")
    script.
      $(document).ready(function(){
        $.getJSON("https://s3-ap-northeast-1.amazonaws.com/sanix-data-analysis/fhRK0XGVb3cR1r1S3x9j3j3DRFGUyRYC/detectLowGeneration2/list.json", function (data) {
          var HEADER = !{JSON.stringify(HEADER)};
          for (var l = 0; l < data.length; l++)　{
            var line = data[l];
            var row = "<tr>";
            for (var i = 0; i < HEADER.length; i++) {
            	var obj = line[i];
              row += "<td>" + (obj ? obj : '&nbsp') + "</td>";
            }
            row += "</tr>";
            $("#mytable").append(row);
            $("tr").each(function() {
              var first = $(this).children("td:first-child").text();
              if (first === '警告') {
                $(this).addClass("danger");
              } else if (first === '通知') {
                $(this).addClass("success");
              }
            });
          }
        });
      });